# Artificial Intelligence Project - Candidate Generation

## Overview
This AI project focuses on candidate generation for a kaggle [H&M Personalized Fashion Recommendations](https://www.kaggle.com/competitions/h-and-m-personalized-fashion-recommendations/overview) Competition. The repository has a well-organized directory structure with distinct folders, each serving a specific purpose. The project demonstrates a systematic approach to candidate generation and evaluation, with a clear structure facilitating collaboration and reproducibility.

## Structure
Local structure differes from files on the online repo, as datasets and other unnecessary files were not submitted (but they can be recreated by running the scripts). The structure is as follows:
```
ai_project
│
├── ai-project-23-24
│   ├── JakubNiedziela
│   ├── README.md
│   ├── ........
│   └── Other Students
└── data
    ├── articles.csv
    ├── customers.csv
    ├── transactions_train.csv
    ├── sample_submission.csv
    ├── candidates
    ├── candidates_100
    ├── candidates_200_ranks
    ├── candidates_50
    ├── compressed_data
    ├── k_sim_results
    ├── mappings
    └── submissions
```

## Repository files
### 01_eda/
- #### 01_eda.ipynb
    File with exploratory data analysis.
- #### articles_report.html
    File automatically generated by <b>[YData Profiling](https://docs.profiling.ydata.ai/latest/)</b> python package.
- #### reduce_memory.ipynb
    File with scripts used to reduce dataset memory.
### 02_feature_engineering/
- #### 02_feauture_engineering.ipynb
    - File with feature engineering;
    - Built on Radek's notebook - just a section in the middle is about creating new features and then joining them.
### 03_candidate_gen_v1/
- #### 03_RQ1_candidate_generation.ipynb
    - File with scripts that can used to create candidates;
    - For Diversity based candidates it was just function that was developed here - no code run.
- #### 03_RQ1_candidate_evaluation.ipynb
    - File with scripts used for generating and evaluating candidates;
    - Metric used is <b>Mean Average Precision @ 12</b>.
### 04_candidate_gen_v2/

- #### 03_RQ1_candidate_generation_100.ipynb
    - File with scripts used for generating and saving candidates (100 for each customer - K = 100);
    - Includes improved version of diversity candidates function.

- #### 04_RQ1_candidate_evaluation.ipynb
    - File with scripts used for generating and evaluating candidates;
    - Metric used is <b>Recall @ 100</b>.

### 05_candidate_eval_simulations/
- #### 05_candidate_generation_simulations.ipynb
    - File with scripts to run candidate generation function with different values of K and then evaluate them using <b>Recall@K</b>;
    - Contains plots used in report and presentation.

### 06_candidate_generation_v3_FINAL/
Uses improved and final version of candidate generation functions from <b>candidate_generation.py</b>.
- #### 06_candidate_generation_not_interacted.ipynb
    - File with scripts to generate and save diversity based candidates;
    - Weekly granularity of candidates;
    - 200 candidates per week per customer.
- #### 06_candidate_generation_seasonal_best.ipynb
    - File with scripts to generate and save seasonal bestsellers candidates;
    - 200 candidates (bestsellers are same for all).

- #### 06_candidate_generation_weekly_sim.ipynb
    - File with scripts to generate and save similar not bought candidates (Hard Negatives);
    - Weekly granularity of candidates;
    - 200 candidates per week per customer.

### 07_candidate_insights/
- #### 07_candidate_insights.ipynb
    - File with scripts that aim to understand whether generated candidates work better for specific customer groups;
    - Contains plots used in reprot and presentation.

### 08_FINAL_submissions/
Files in this folder are used to make submission to kaggle to check scores for different K values as well as generate final submissions for project.
- #### 08_final_submission_all_with_radek.ipynb
    Submission including Radek's and my candidates.
- #### 08_final_submission_all_without_radek.ipynb
    Submission including only my candidates.
- #### 08_final_submission_niw_colour_group.ipynb
    Submission including Radek's candidates and my Diversity Candidates by colour_group_name column in articles.csv
- #### 08_final_submission_garment_group.ipynb
    Submission including Radek's candidates and my Diversity Candidates by garment_group_name column in articles.csv
- #### 08_final_submission_.ipynb
    Submission including Radek's candidates and my Diversity Candidates by section_name column in articles.csv
- #### 08_final_submission_seasonal.ipynb
    Submission including Radek's candidates and my seasonal bestsellers.
- #### 08_final_submission_.ipynb
    Submission including Radek's candidates and my similar not bought (Hard Negatives).

### 99_submissions_simple/
Folder with short scripts I made at the start of project for fun and to get an idea how it all works.

### candidate_generation.py
Contains functions used for candidate generation process.
### eval_helpers.py
Contains functions used for candidate evaluation process.
### model.py
- Contains functions used for final submissions;
- Follows logic created used by Radek's baseline.